{"ast":null,"code":"const express = require('express');\nconst http = require('http');\nconst socketIo = require('socket.io');\nconst cors = require('cors');\nconst bodyParser = require('body-parser');\nrequire('dotenv').config();\nconst connectDB = require('./utils/db');\n\n// Import routes\nconst authRoutes = require('./routes/auth');\nconst accountRoutes = require('./routes/account');\nconst tournamentRoutes = require('./routes/tournament');\nconst matchmakingRoutes = require('./routes/matchmaking');\nconst matchRoutes = require('./routes/match');\n\n// Initialize app and server\nconst app = express();\nconst server = http.createServer(app);\nconst io = socketIo(server, {\n  cors: {\n    origin: '*',\n    methods: ['GET', 'POST']\n  }\n});\n\n// Middleware\napp.use(cors());\napp.use(bodyParser.json());\n\n// Connect to MongoDB\nconnectDB();\n\n// Routes\napp.use('/auth', authRoutes);\napp.use('/account', accountRoutes);\napp.use('/tournament', tournamentRoutes);\napp.use('/matchmaking', matchmakingRoutes);\napp.use('/match', matchRoutes);\n\n// Matchmaking logic\nlet queue = [];\nconst matches = {};\nio.on('connection', socket => {\n  console.log(`User connected: ${socket.id}`);\n\n  // Join queue\n  socket.on('joinQueue', ({\n    username,\n    discordId,\n    epicName,\n    tournamentId\n  }) => {\n    if (!username || !tournamentId) {\n      socket.emit('error', {\n        message: 'Username and Tournament ID are required to join the queue.'\n      });\n      return;\n    }\n    const avatarUrl = discordId ? `https://cdn.discordapp.com/avatars/${discordId}/${discordId}.png` : '/default-avatar.png';\n    const player = {\n      id: socket.id,\n      username,\n      epicName,\n      avatarUrl,\n      tournamentId\n    };\n    queue.push(player);\n    console.log(`[QUEUE UPDATE]: ${queue.length} players in the queue.`);\n    console.log(`[QUEUE STATE]:`, queue);\n\n    // Match players\n    const tournamentQueue = queue.filter(p => p.tournamentId === tournamentId);\n    if (tournamentQueue.length >= 2) {\n      const [player1, player2] = tournamentQueue.splice(0, 2); // Remove matched players from the queue\n      const matchId = `${player1.id}-${player2.id}`;\n      matches[matchId] = {\n        player1,\n        player2\n      };\n      console.log(`[MATCH CREATED]: ${player1.epicName} vs ${player2.epicName}`);\n      const room = `match-${matchId}`;\n      socket.join(room);\n      io.to(player1.id).emit('matchFound', {\n        matchId,\n        self: player1,\n        opponent: player2\n      });\n      io.to(player2.id).emit('matchFound', {\n        matchId,\n        self: player2,\n        opponent: player1\n      });\n    } else {\n      socket.emit('waiting', {\n        message: 'You are in the queue. Waiting for another player...'\n      });\n    }\n  });\n\n  // Handle chat\n  socket.on('sendMessage', ({\n    matchId,\n    message,\n    sender\n  }) => {\n    const room = `match-${matchId}`;\n    io.to(room).emit('receiveMessage', {\n      sender,\n      message\n    });\n  });\n\n  // Leave queue\n  socket.on('leaveQueue', ({\n    username,\n    tournamentId\n  }) => {\n    console.log(`${username} left the queue for tournament ${tournamentId}`);\n    queue = queue.filter(p => p.id !== socket.id);\n    socket.emit('queueLeft', {\n      message: 'You have left the queue.'\n    });\n  });\n\n  // Disconnect\n  socket.on('disconnect', () => {\n    queue = queue.filter(p => p.id !== socket.id);\n    for (const matchId in matches) {\n      if (matches[matchId].player1.id === socket.id || matches[matchId].player2.id === socket.id) {\n        delete matches[matchId];\n        console.log(`Match ${matchId} canceled due to player disconnect.`);\n      }\n    }\n  });\n});\n\n// Start the server\nconst PORT = process.env.PORT || 5000;\nserver.listen(PORT, () => {\n  console.log(`Server running on http://localhost:${PORT}`);\n});","map":{"version":3,"names":["express","require","http","socketIo","cors","bodyParser","config","connectDB","authRoutes","accountRoutes","tournamentRoutes","matchmakingRoutes","matchRoutes","app","server","createServer","io","origin","methods","use","json","queue","matches","on","socket","console","log","id","username","discordId","epicName","tournamentId","emit","message","avatarUrl","player","push","length","tournamentQueue","filter","p","player1","player2","splice","matchId","room","join","to","self","opponent","sender","PORT","process","env","listen"],"sources":["C:/Users/souy/Desktop/best website/frontend/src/App.js"],"sourcesContent":["const express = require('express');\r\nconst http = require('http');\r\nconst socketIo = require('socket.io');\r\nconst cors = require('cors');\r\nconst bodyParser = require('body-parser');\r\nrequire('dotenv').config();\r\n\r\nconst connectDB = require('./utils/db');\r\n\r\n// Import routes\r\nconst authRoutes = require('./routes/auth');\r\nconst accountRoutes = require('./routes/account');\r\nconst tournamentRoutes = require('./routes/tournament');\r\nconst matchmakingRoutes = require('./routes/matchmaking');\r\nconst matchRoutes = require('./routes/match');\r\n\r\n// Initialize app and server\r\nconst app = express();\r\nconst server = http.createServer(app);\r\nconst io = socketIo(server, {\r\n  cors: {\r\n    origin: '*',\r\n    methods: ['GET', 'POST'],\r\n  },\r\n});\r\n\r\n// Middleware\r\napp.use(cors());\r\napp.use(bodyParser.json());\r\n\r\n// Connect to MongoDB\r\nconnectDB();\r\n\r\n// Routes\r\napp.use('/auth', authRoutes);\r\napp.use('/account', accountRoutes);\r\napp.use('/tournament', tournamentRoutes);\r\napp.use('/matchmaking', matchmakingRoutes);\r\napp.use('/match', matchRoutes);\r\n\r\n// Matchmaking logic\r\nlet queue = [];\r\nconst matches = {};\r\n\r\nio.on('connection', (socket) => {\r\n  console.log(`User connected: ${socket.id}`);\r\n\r\n  // Join queue\r\n  socket.on('joinQueue', ({ username, discordId, epicName, tournamentId }) => {\r\n    if (!username || !tournamentId) {\r\n      socket.emit('error', { message: 'Username and Tournament ID are required to join the queue.' });\r\n      return;\r\n    }\r\n\r\n    const avatarUrl = discordId\r\n      ? `https://cdn.discordapp.com/avatars/${discordId}/${discordId}.png`\r\n      : '/default-avatar.png';\r\n\r\n    const player = { id: socket.id, username, epicName, avatarUrl, tournamentId };\r\n    queue.push(player);\r\n\r\n    console.log(`[QUEUE UPDATE]: ${queue.length} players in the queue.`);\r\n    console.log(`[QUEUE STATE]:`, queue);\r\n\r\n    // Match players\r\n    const tournamentQueue = queue.filter((p) => p.tournamentId === tournamentId);\r\n    if (tournamentQueue.length >= 2) {\r\n      const [player1, player2] = tournamentQueue.splice(0, 2); // Remove matched players from the queue\r\n      const matchId = `${player1.id}-${player2.id}`;\r\n      matches[matchId] = { player1, player2 };\r\n\r\n      console.log(`[MATCH CREATED]: ${player1.epicName} vs ${player2.epicName}`);\r\n\r\n      const room = `match-${matchId}`;\r\n      socket.join(room);\r\n\r\n      io.to(player1.id).emit('matchFound', { matchId, self: player1, opponent: player2 });\r\n      io.to(player2.id).emit('matchFound', { matchId, self: player2, opponent: player1 });\r\n    } else {\r\n      socket.emit('waiting', { message: 'You are in the queue. Waiting for another player...' });\r\n    }\r\n  });\r\n\r\n  // Handle chat\r\n  socket.on('sendMessage', ({ matchId, message, sender }) => {\r\n    const room = `match-${matchId}`;\r\n    io.to(room).emit('receiveMessage', { sender, message });\r\n  });\r\n\r\n  // Leave queue\r\n  socket.on('leaveQueue', ({ username, tournamentId }) => {\r\n    console.log(`${username} left the queue for tournament ${tournamentId}`);\r\n    queue = queue.filter((p) => p.id !== socket.id);\r\n    socket.emit('queueLeft', { message: 'You have left the queue.' });\r\n  });\r\n\r\n  // Disconnect\r\n  socket.on('disconnect', () => {\r\n    queue = queue.filter((p) => p.id !== socket.id);\r\n\r\n    for (const matchId in matches) {\r\n      if (matches[matchId].player1.id === socket.id || matches[matchId].player2.id === socket.id) {\r\n        delete matches[matchId];\r\n        console.log(`Match ${matchId} canceled due to player disconnect.`);\r\n      }\r\n    }\r\n  });\r\n});\r\n\r\n// Start the server\r\nconst PORT = process.env.PORT || 5000;\r\nserver.listen(PORT, () => {\r\n  console.log(`Server running on http://localhost:${PORT}`);\r\n});\r\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,IAAI,GAAGD,OAAO,CAAC,MAAM,CAAC;AAC5B,MAAME,QAAQ,GAAGF,OAAO,CAAC,WAAW,CAAC;AACrC,MAAMG,IAAI,GAAGH,OAAO,CAAC,MAAM,CAAC;AAC5B,MAAMI,UAAU,GAAGJ,OAAO,CAAC,aAAa,CAAC;AACzCA,OAAO,CAAC,QAAQ,CAAC,CAACK,MAAM,CAAC,CAAC;AAE1B,MAAMC,SAAS,GAAGN,OAAO,CAAC,YAAY,CAAC;;AAEvC;AACA,MAAMO,UAAU,GAAGP,OAAO,CAAC,eAAe,CAAC;AAC3C,MAAMQ,aAAa,GAAGR,OAAO,CAAC,kBAAkB,CAAC;AACjD,MAAMS,gBAAgB,GAAGT,OAAO,CAAC,qBAAqB,CAAC;AACvD,MAAMU,iBAAiB,GAAGV,OAAO,CAAC,sBAAsB,CAAC;AACzD,MAAMW,WAAW,GAAGX,OAAO,CAAC,gBAAgB,CAAC;;AAE7C;AACA,MAAMY,GAAG,GAAGb,OAAO,CAAC,CAAC;AACrB,MAAMc,MAAM,GAAGZ,IAAI,CAACa,YAAY,CAACF,GAAG,CAAC;AACrC,MAAMG,EAAE,GAAGb,QAAQ,CAACW,MAAM,EAAE;EAC1BV,IAAI,EAAE;IACJa,MAAM,EAAE,GAAG;IACXC,OAAO,EAAE,CAAC,KAAK,EAAE,MAAM;EACzB;AACF,CAAC,CAAC;;AAEF;AACAL,GAAG,CAACM,GAAG,CAACf,IAAI,CAAC,CAAC,CAAC;AACfS,GAAG,CAACM,GAAG,CAACd,UAAU,CAACe,IAAI,CAAC,CAAC,CAAC;;AAE1B;AACAb,SAAS,CAAC,CAAC;;AAEX;AACAM,GAAG,CAACM,GAAG,CAAC,OAAO,EAAEX,UAAU,CAAC;AAC5BK,GAAG,CAACM,GAAG,CAAC,UAAU,EAAEV,aAAa,CAAC;AAClCI,GAAG,CAACM,GAAG,CAAC,aAAa,EAAET,gBAAgB,CAAC;AACxCG,GAAG,CAACM,GAAG,CAAC,cAAc,EAAER,iBAAiB,CAAC;AAC1CE,GAAG,CAACM,GAAG,CAAC,QAAQ,EAAEP,WAAW,CAAC;;AAE9B;AACA,IAAIS,KAAK,GAAG,EAAE;AACd,MAAMC,OAAO,GAAG,CAAC,CAAC;AAElBN,EAAE,CAACO,EAAE,CAAC,YAAY,EAAGC,MAAM,IAAK;EAC9BC,OAAO,CAACC,GAAG,CAAC,mBAAmBF,MAAM,CAACG,EAAE,EAAE,CAAC;;EAE3C;EACAH,MAAM,CAACD,EAAE,CAAC,WAAW,EAAE,CAAC;IAAEK,QAAQ;IAAEC,SAAS;IAAEC,QAAQ;IAAEC;EAAa,CAAC,KAAK;IAC1E,IAAI,CAACH,QAAQ,IAAI,CAACG,YAAY,EAAE;MAC9BP,MAAM,CAACQ,IAAI,CAAC,OAAO,EAAE;QAAEC,OAAO,EAAE;MAA6D,CAAC,CAAC;MAC/F;IACF;IAEA,MAAMC,SAAS,GAAGL,SAAS,GACvB,sCAAsCA,SAAS,IAAIA,SAAS,MAAM,GAClE,qBAAqB;IAEzB,MAAMM,MAAM,GAAG;MAAER,EAAE,EAAEH,MAAM,CAACG,EAAE;MAAEC,QAAQ;MAAEE,QAAQ;MAAEI,SAAS;MAAEH;IAAa,CAAC;IAC7EV,KAAK,CAACe,IAAI,CAACD,MAAM,CAAC;IAElBV,OAAO,CAACC,GAAG,CAAC,mBAAmBL,KAAK,CAACgB,MAAM,wBAAwB,CAAC;IACpEZ,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAEL,KAAK,CAAC;;IAEpC;IACA,MAAMiB,eAAe,GAAGjB,KAAK,CAACkB,MAAM,CAAEC,CAAC,IAAKA,CAAC,CAACT,YAAY,KAAKA,YAAY,CAAC;IAC5E,IAAIO,eAAe,CAACD,MAAM,IAAI,CAAC,EAAE;MAC/B,MAAM,CAACI,OAAO,EAAEC,OAAO,CAAC,GAAGJ,eAAe,CAACK,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;MACzD,MAAMC,OAAO,GAAG,GAAGH,OAAO,CAACd,EAAE,IAAIe,OAAO,CAACf,EAAE,EAAE;MAC7CL,OAAO,CAACsB,OAAO,CAAC,GAAG;QAAEH,OAAO;QAAEC;MAAQ,CAAC;MAEvCjB,OAAO,CAACC,GAAG,CAAC,oBAAoBe,OAAO,CAACX,QAAQ,OAAOY,OAAO,CAACZ,QAAQ,EAAE,CAAC;MAE1E,MAAMe,IAAI,GAAG,SAASD,OAAO,EAAE;MAC/BpB,MAAM,CAACsB,IAAI,CAACD,IAAI,CAAC;MAEjB7B,EAAE,CAAC+B,EAAE,CAACN,OAAO,CAACd,EAAE,CAAC,CAACK,IAAI,CAAC,YAAY,EAAE;QAAEY,OAAO;QAAEI,IAAI,EAAEP,OAAO;QAAEQ,QAAQ,EAAEP;MAAQ,CAAC,CAAC;MACnF1B,EAAE,CAAC+B,EAAE,CAACL,OAAO,CAACf,EAAE,CAAC,CAACK,IAAI,CAAC,YAAY,EAAE;QAAEY,OAAO;QAAEI,IAAI,EAAEN,OAAO;QAAEO,QAAQ,EAAER;MAAQ,CAAC,CAAC;IACrF,CAAC,MAAM;MACLjB,MAAM,CAACQ,IAAI,CAAC,SAAS,EAAE;QAAEC,OAAO,EAAE;MAAsD,CAAC,CAAC;IAC5F;EACF,CAAC,CAAC;;EAEF;EACAT,MAAM,CAACD,EAAE,CAAC,aAAa,EAAE,CAAC;IAAEqB,OAAO;IAAEX,OAAO;IAAEiB;EAAO,CAAC,KAAK;IACzD,MAAML,IAAI,GAAG,SAASD,OAAO,EAAE;IAC/B5B,EAAE,CAAC+B,EAAE,CAACF,IAAI,CAAC,CAACb,IAAI,CAAC,gBAAgB,EAAE;MAAEkB,MAAM;MAAEjB;IAAQ,CAAC,CAAC;EACzD,CAAC,CAAC;;EAEF;EACAT,MAAM,CAACD,EAAE,CAAC,YAAY,EAAE,CAAC;IAAEK,QAAQ;IAAEG;EAAa,CAAC,KAAK;IACtDN,OAAO,CAACC,GAAG,CAAC,GAAGE,QAAQ,kCAAkCG,YAAY,EAAE,CAAC;IACxEV,KAAK,GAAGA,KAAK,CAACkB,MAAM,CAAEC,CAAC,IAAKA,CAAC,CAACb,EAAE,KAAKH,MAAM,CAACG,EAAE,CAAC;IAC/CH,MAAM,CAACQ,IAAI,CAAC,WAAW,EAAE;MAAEC,OAAO,EAAE;IAA2B,CAAC,CAAC;EACnE,CAAC,CAAC;;EAEF;EACAT,MAAM,CAACD,EAAE,CAAC,YAAY,EAAE,MAAM;IAC5BF,KAAK,GAAGA,KAAK,CAACkB,MAAM,CAAEC,CAAC,IAAKA,CAAC,CAACb,EAAE,KAAKH,MAAM,CAACG,EAAE,CAAC;IAE/C,KAAK,MAAMiB,OAAO,IAAItB,OAAO,EAAE;MAC7B,IAAIA,OAAO,CAACsB,OAAO,CAAC,CAACH,OAAO,CAACd,EAAE,KAAKH,MAAM,CAACG,EAAE,IAAIL,OAAO,CAACsB,OAAO,CAAC,CAACF,OAAO,CAACf,EAAE,KAAKH,MAAM,CAACG,EAAE,EAAE;QAC1F,OAAOL,OAAO,CAACsB,OAAO,CAAC;QACvBnB,OAAO,CAACC,GAAG,CAAC,SAASkB,OAAO,qCAAqC,CAAC;MACpE;IACF;EACF,CAAC,CAAC;AACJ,CAAC,CAAC;;AAEF;AACA,MAAMO,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACF,IAAI,IAAI,IAAI;AACrCrC,MAAM,CAACwC,MAAM,CAACH,IAAI,EAAE,MAAM;EACxB1B,OAAO,CAACC,GAAG,CAAC,sCAAsCyB,IAAI,EAAE,CAAC;AAC3D,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}